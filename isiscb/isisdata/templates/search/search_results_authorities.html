{% load app_filters %}
{% load metadata_filters %}

{% if query %}
    <h3>Search Results</h3>
    <div class="results-info">Showing {{ page.authority.start_index }} to {{ page.authority.end_index }} of {{ count_authority }} results.</div>

    {% for result in page.authority.object_list %}
    <p>
          <span class="glyphicon glyphicon-bookmark"></span>
          [{{ result.object.get_type_controlled_display }}]
          <a href="{% url 'index' result.object.id %}?fromsearch=true">{{ result.name }}</a>
          {% with result.object|get_dates as dates %}
          {% if dates %}({{ dates|join_attributes:', ' }}){% endif %}
          {% endwith %}

        </p>
    {% empty %}
        <p>No results found.</p>
    {% endfor %}
    {% if page.authority.has_previous or page.authority.has_next %}
    <nav>
      <ul class="pagination">
        <li class="disabled"><a>Go to page:</a></li>

          {% if page.authority.has_previous %}
          <li>
            {% with pagenr=page.authority.previous_page_number|stringformat:"s"  %}
            {% with ppage='page_authority:'|add:pagenr %}
            <a href="{{ request.get_full_path|set_page:ppage|set_index_model:'models:isisdata.authority' }}" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
            </a>
            {% endwith %}
            {% endwith %}
          </li>
          {% else %}
          <li class="disabled">
            {% with pagenr=page.authority.number|stringformat:"s"  %}
            {% with ppage='page_authority:'|add:pagenr %}
            <a href="{{ request.get_full_path|set_page:ppage|set_index_model:'models:isisdata.authority' }}" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
            </a>
            {% endwith %}
            {% endwith %}
          </li>
          {% endif %}
          {% if page.authority.has_previous or page.authority.has_next %}
          {% for p in page.authority.paginator.page_range %}
          {% with pagenr=forloop.counter|stringformat:"s" %}
          {% with ppage='page_authority:'|add:pagenr %}
              <li {% if page.authority.number == p %} class="active" {% endif %}><a href="{{ request.get_full_path|set_page:ppage|set_index_model:'models:isisdata.authority' }}">{{ p }}</a></li>
          {% endwith %}
          {% endwith %}
          {% endfor %}
          {% endif %}
          {% if page.authority.has_next %}
          <li>
            {% with pagenr=page.authority.next_page_number|stringformat:"s" %}
            {% with ppage='page_authority:'|add:pagenr %}
            <a href="{{ request.get_full_path|set_page:ppage|set_index_model:'models:isisdata.authority' }}" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
            </a>
            {% endwith %}
            {% endwith %}
          </li>
          {% else %}
          <li class="disabled">
            {% with pagenr=page.authority.number|stringformat:"s" %}
            {% with ppage='page_authority:'|add:pagenr %}
            <a href="{{ request.get_full_path|set_page:ppage|set_index_model:'models:isisdata.authority' }}" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
            </a>
            {% endwith %}
            {% endwith %}
          </li>
          {% endif %}
        </ul>
      </nav>
      {% endif %}
{% else %}
    {# Show some example queries to run, maybe query syntax, something else? #}
{% endif %}
