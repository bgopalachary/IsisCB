{% load app_filters %}
{% load metadata_filters %}

{% if query and 'isisdata.citation' in models %}

    <h3>Search Results</h3>
    <div class="results-info">Showing {{ page.start_index }} to {{ page.end_index }} of {{ count }} results.</div>

    {% for result in page.object_list %}
    <p>
          <span class="glyphicon glyphicon-book"></span>
          [{{ result.object.get_type_controlled_display }}]

          <br>
            {% if result.authors|joinby:"; " %}
            {{ result.authors | joinby:"; " }};
            {% else %}
            Author missing;
            {% endif %}

            <a href="{% url 'index' result.object.id %}">{{ result.object|get_title|bleach_safe }}</a>
            {% if result.object|get_pub_year %}({{ result.object|get_pub_year }}){% endif %}
            <!-- Zotero -->
            <span style="display:none;">
               <abbr class="unapi-id" title="{{ result.object.id }}">unapi</abbr>
            </span>

        </p>
    {% empty %}
        <p>No results found.</p>
    {% endfor %}
    {% if page.has_previous or page.has_next %}
    <nav>
      <ul class="pagination">
        <li class="disabled"><a>Go to page:</a></li>

          {% if page.has_previous %}
          <li>
            <a href="?q={{ query }}{% if selected_facets_raw %}&amp;selected_facets={{ selected_facets_raw|join:'&selected_facets=' }}{% endif %}{% if models %}&amp;models={{ models|join:'&amp;models=' }}{% endif %}&amp;page={{ page.previous_page_number }}" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
            </a>
          </li>
          {% else %}
          <li class="disabled">
            <a href="?q={{ query }}{% if selected_facets_raw %}&amp;selected_facets={{ selected_facets_raw|join:'&selected_facets=' }}{% endif %}{% if models %}&amp;models={{ models|join:'&amp;models=' }}{% endif %}&amp;page={{ page.number }}" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
            </a>
          </li>
          {% endif %}
          {% if page.has_previous or page.has_next %}
          {% for p in page.paginator.page_range %}
              <li {% if page.number == p %} class="active" {% endif %}><a href="?q={{ query }}{% if selected_facets_raw %}&amp;selected_facets={{ selected_facets_raw|join:'&selected_facets=' }}{% endif %}{% if models %}&amp;models={{ models|join:'&amp;models=' }}{% endif %}&amp;page={{ forloop.counter }}">{{ p }}</a></li>
          {% endfor %}
          {% endif %}
          {% if page.has_next %}
          <li>
            <a href="?q={{ query }}{% if selected_facets_raw %}&amp;selected_facets={{ selected_facets_raw|join:'&selected_facets=' }}{% endif %}{% if models %}&amp;models={{ models|join:'&amp;models=' }}{% endif %}&amp;page={{ page.next_page_number }}" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
            </a>
          </li>
          {% else %}
          <li class="disabled">
            <a href="?q={{ query }}{% if selected_facets_raw %}&amp;selected_facets={{ selected_facets_raw|join:'&selected_facets=' }}{% endif %}{% if models %}&amp;models={{ models|join:'&amp;models=' }}{% endif %}&amp;page={{ page.number }}" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
            </a>
          </li>
          {% endif %}
        </ul>
      </nav>
      {% endif %}
{% else %}
    {# Show some example queries to run, maybe query syntax, something else? #}
{% endif %}
