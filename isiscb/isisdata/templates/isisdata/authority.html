{% extends "isisdata/__base.html" %}
{% load app_filters %}

{% block title %}Authority{% endblock %}

{% block content %}
<div class="row">
  <div class="col-sm-3 col-md-2 sidebar">
    <div class="menu">
      <a href="javascript:window.history.back()"><span class="glyphicon glyphicon-arrow-left"></span></a>
      &nbsp; &nbsp;
      <a href="{% url 'haystack_search' %}"><span class="glyphicon glyphicon-home"></span></a>
      &nbsp; &nbsp;
      <a href="{% url 'haystack_search' %}"><span class="glyphicon glyphicon-search"></span></a>
      <hr>
    </div>
  </div>
  <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
    <div class="alert alert-info headerbox" role="alert">{{ authority.get_type_controlled_display }}</div>

    <h3>{{ authority.name }}</h3>

    <p><strong>Description:</strong> {{ authority.description }}</p>

    {% for attribute in authority.attributes.all %}
    <p><strong>{{ attribute.type_controlled }}:</strong> {{ attribute.value }}</p>
    {% endfor %}

    {% if citations_by %}
    <h4>Resources by {{ authority.name }}</h4>
      {% for rel_citation in citations_by %}
        <p>
          {% if rel_citation.citation|get_authors %}
          {% for author in rel_citation.citation|get_authors %} {{ author.authority.name }};{% endfor %}<br>
          {% endif %}
          <a href="{% url 'citation' rel_citation.citation.id %}">{{ rel_citation.citation.title|default:"No title specified" }}</a></li>
        </p>
      {% endfor %}
      <nav>
        <ul class="pagination">
          <li>
            {% if citations_by.has_previous %}
            <a href="?page-by={{ citations_by.previous_page_number }}" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
            </a>
            {% endif %}
            {% if citations_by.has_previous or citations_by.has_next %}
            {% for page in citations_by.paginator.page_range %}
                <li {% if citations_by.number == page %} class="disabled" {% endif %}><a href="?page-by={{ forloop.counter }}">{{ page }}</a></li>
            {% endfor %}
            {% endif %}
            {% if citations_by.has_next %}
            <li>
              <a href="?page-by={{ citations_by.next_page_number }}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
            {% endif %}
          </ul>
        </nav>
    {% endif %}

    {% if citations_about %}
    <h4>Resources about {{ authority.name }}</h4>

      {% for rel_citation in citations_about %}
        <p>
          {% if rel_citation.citation|get_authors %}
          {% for author in rel_citation.citation|get_authors %} {{ author.authority.name }};{% endfor %}<br>
          {% endif %}
          <a href="{% url 'citation' rel_citation.citation.id %}">{{ rel_citation.citation.title|default:"No title specified" }}</a></li>
        </p>
      {% endfor %}

      <nav>
        <ul class="pagination">
          <li>
            {% if citations_about.has_previous %}
            <a href="?page-about={{ citations_about.previous_page_number }}" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
            </a>
            {% endif %}
            {% if citations_about.has_previous or citations_about.has_next %}
            {% for page in citations_about.paginator.page_range %}
                <li {% if citations_about.number == page %} class="active" {% endif %}><a href="?page-about={{ forloop.counter }}">{{ page }}</a></li>
            {% endfor %}
            {% endif %}
            {% if citations_about.has_next %}
            <li>
              <a href="?page-about={{ citations_about.next_page_number }}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
            {% endif %}
          </ul>
        </nav>
    {% endif %}

    {% if citations_other %}
    <h4>Resources about {{ authority.name }}</h4>

      {% for rel_citation in citations_other.all %}
          <p>
            {% if rel_citation.citation|get_authors %}
            {% for author in rel_citation.citation|get_authors %} {{ author.authority.name }};{% endfor %}<br>
            {% endif %}
            <a href="{% url 'citation' rel_citation.citation.id %}">{{ rel_citation.citation.title|default:"No title specified" }}</a>
          </p>
      {% endfor %}
      <nav>
        <ul class="pagination">
          <li>
            {% if citations_other.has_previous %}
            <a href="?page-other={{ citations_other.previous_page_number }}" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
            </a>
            {% endif %}
            {% if citations_other.has_previous or citations_other.has_next %}
            {% for page in citations_other.paginator.page_range %}
                <li><a href="?page-other={{ forloop.counter }}">{{ page }}</a></li>
            {% endfor %}
            {% endif %}
            {% if citations_other.has_next %}
            <li>
              <a href="?page-other={{ citations_other.next_page_number }}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
            {% endif %}
          </ul>
        </nav>
    {% endif %}
    </div>

  </div>


</div>
{% endblock %}
