{% load render_object %}

<ul class="list-group">
{% for acrelation in instance.acrelation_set.all %}
    <li class="list-group-item" id="acrelation-{{ acrelation.id }}">
        <span class="label label-primary">{{ acrelation.get_type_controlled_display }}</span>
        {% if acrelation.type_broad_controlled %}
        <span class="label label-success">{{ acrelation.get_type_broad_controlled_display }}</span>
        {% endif %}
        {{ acrelation.authority.name }}
        {% if acrelation.name_for_display_in_citation %}
        <span class="text-muted">(as "{{ acrelation.name_for_display_in_citation }}")</span>
        {% endif %}

        <span class="button-group button-group-xs pull-right">
            <a href="{% url "update_acrelation_for_citation" instance.id acrelation.id %}" class="btn btn-xs glyphicon glyphicon-pencil"></a>
            <a class="btn btn-xs glyphicon glyphicon-remove delete delete-acrelation" data-target="{{ acrelation.id }}"></a>
        </span>
    </li>
{% endfor %}
    <a class="list-group-item text-muted" href="{% url "create_acrelation_for_citation" instance.id %}">
        <span class="glyphicon glyphicon-plus"></span> Create new relation
    </a>
</ul>

<script>
$(document).ready(function() {
    $('.delete-acrelation').click(function() {
        var elem = $(this);
        var acrelation_id = elem.attr('data-target');
        $.ajax("{% url "create_acrelation_for_citation" instance.id %}" + acrelation_id + '/delete.json?confirm=true', {
            'success': function(r) {
                $('#acrelation-' + acrelation_id).remove();
            },
        });
    });
});
</script>
