{% extends "curation/base.html" %}

{% load addcss %}
{% load pagination_tags %}
{% load render_object %}
{% load permission_tags %}
{% load rules %}


{% block content %}
{% autopaginate objects 40 as filter_list %}

{% test_rule 'can_update_user_module' user as update_module %}
{% if update_module %}
<div class="row">
  <div class="col-md-12">
    <a class="btn btn-primary" href="{% url "create_role" %}">Create new role</a>
  </div>
</div>
{% endif %}

<div class="text-center">
    {% paginate %}
</div>

<div class="panel">
    <table class="table table-striped table-responsive table-hover table-curation">
      <thead>
        <tr>
          <th>Username</th>
          <th></th>
          <th>Email</th>
          <th>Roles</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for user in filter_list %}
        <tr>
          <td>
            <a href="{% url 'user' user.pk %}">{{ user.username }}</a>
          </td>
          <td>
            {% if user.is_superuser %}<span class="label label-danger">Administrator</span> {% endif %}
            {% if user.is_staff %}<span class="label label-warning">Curation Access</span>{% endif %}
          </td>
          <td>
            {{ user.email }}
          </td>
          <td>
            {% for role in user.pk|roles %}
              <a href="{% url 'role' role.pk %}">{{ role.name }}</a>,
            {% endfor %}
          </td>
          <td>
            {% if update_module %}
            <a href="{% url 'add_role_to_user' user.pk %}"><i class="fa fa-plus-circle" aria-hidden="true"></i> Role</a>
            <a href="{% url 'user' user.pk %}"><i class="fa fa-cog" aria-hidden="true"></i> User Profile</a>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="panel-footer text-center">
    {% paginate %}
    </div>


</div>

{% endblock %}
